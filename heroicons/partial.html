{{- $attrList := slice "class" ":class" "title" ":title" "x-show" "@click" "x-cloak" -}}
{{- $variantDir := "24/outline" -}}
{{- with .variant -}}
{{-   if ne . "outline" "solid" "mini" "micro" -}}
{{-     warnf "Invalid variant %q defaulting location to %q" . $variantDir -}}
{{-   else -}}
{{-     if eq . "outline" -}}
{{-       $variantDir = "24/outline" -}}
{{-     else if eq . "solid" -}}
{{-       $variantDir = "24/solid" -}}
{{-     else if eq . "mini" -}}
{{-       $variantDir = "20/solid" -}}
{{-     else if eq . "micro" -}}
{{-       $variantDir = "16/solid" -}}
{{-     end -}}
{{-   end -}}
{{- end -}}
{{- $opts := dict -}}
{{- range $attr, $value := . -}}
{{-   if -}}
{{-   $opts = merge $opts (dict $attr $value) -}}
{{- end -}}
{{- with $icon := .icon -}}
{{-   $iconPath := printf "heroicons/%s/%s.svg" $variantDir $icon -}}
{{-   with (resources.Get (printf "heroicons/%s/%s.svg" $variantDir $icon)) -}}
{{-     $svg := .Content -}}
{{-     range $attr := $attrList -}}
{{-       with ($scratch.Get $attr) -}}
{{-         if (eq $attr "title") -}}
{{-           $svg = replaceRE "(.*)</svg>" (printf "$1\n<title>%s</title>\n</svg>" .) $svg -}}
{{-         else if (eq $attr ":title") -}}
{{-           $svg = replaceRE "(.*)</svg>" (printf "$1\n<title x-text=\"%s\"></title>\n</svg>" .) $svg -}}
{{-         else if (eq $attr "x-cloak") -}}
{{-           $svg = replaceRE "<svg (.*)" (printf "<svg %s $1" $attr) $svg -}}
{{-         else -}}
{{-           $value := delimit (slice $attr (printf "\"%s\"" .)) "=" -}}
{{-           $svg = replaceRE "<svg (.*)" (printf "<svg %s $1" $value) $svg -}}
{{-         end -}}
{{-       end -}}
{{-     end -}}
{{-     $svg | safeHTML -}}
{{-   else -}}
{{-     errorf "Could not load %q" $iconPath -}}
{{-   end -}}
{{- else -}}
{{-   warnf "No icon provided for %q" templates.Current.Name -}}
{{- end -}}
