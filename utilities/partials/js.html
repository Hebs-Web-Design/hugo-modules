{{- $js := resources.Get "js/main.js" | js.Build -}}
{{- $preload := dict "as" "script" -}}
{{- if hugo.IsProduction -}}
    {{- $js = $js | minify | fingerprint -}}
    {{- $preload = merge $preload (dict "integrity" $js.Data.Integrity) -}}
{{- end -}}
{{- $preload = merge $preload (dict "href" $js.RelPermalink) -}}
<script src="{{ $js.RelPermalink }}" type="text/javascript"{{ if hugo.IsProduction }} integrity="{{ $js.Data.Integrity }}"{{ end }} async></script>
{{- page.Scratch.Add "preload" (slice $preload) -}}
